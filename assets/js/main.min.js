// test 1
class User {
    constructor(name, email, password) {
      this.name = name;
      this.email = email;
      this.password = password;
    }
  
    validateData() {
      if (!this.name || !this.email || !this.password) {
        return false;
      }
  
      if (this.password.length < 5) {
        return false;
      }
  
      if (!this.email.includes('@')) {
        return false;
      }
  
      return true;
    }
}

  
let testBtns = document.querySelectorAll('.test-btn');
  
if (testBtns) {
    testBtns.forEach(function(item) {
        item.addEventListener('click', function() {
            let name = this.getAttribute('data-name');
            let email = this.getAttribute('data-email');
            let pass = this.getAttribute('data-pass');
    
            let currentUser = new User(name, email, pass);
            let isValid = currentUser.validateData();
  
            if (isValid) {
                alert('true');
            } else {
                alert('false');
            }
        });
    });
}

// end test 1


// test 2

// email validation
function validateEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}
// end email validation

function validateForm(event) {
    event.preventDefault();
  
    const form = event.target;
    const inputs = form.querySelectorAll('input');
    let isValid = true;
  
    inputs.forEach(input => {
        if (!input.value) {
            input.classList.add('error');
            let errorDiv = input.nextSibling

            if (!errorDiv || errorDiv.className !== 'error-message') {
                errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = `${input.name} is required`;
                input.parentNode.insertBefore(errorDiv, input.nextSibling); 
            }

            isValid = false;

        } else {
            if (input.type === 'email' && !validateEmail(input.value)) {
                input.classList.add('error');
                let errorDiv = input.nextSibling; 

                if (!errorDiv || errorDiv.className !== 'error-message') {
                    errorDiv = document.createElement('div');
                    errorDiv.className = 'error-message';
                    errorDiv.textContent = 'Invalid email format';
                    input.parentNode.insertBefore(errorDiv, input.nextSibling);
                }
                isValid = false;

            } else {
                input.classList.remove('error');
                let errorDiv = input.nextSibling;

                if (errorDiv && errorDiv.className === 'error-message') {
                    errorDiv.parentNode.removeChild(errorDiv);
                }
            }
        }
    });
  
    if (isValid) {
        form.submit();
        alert('Форма відправлена!');
    }
}

document.querySelector('.form').addEventListener('submit', validateForm);

// end test2


// test 3
function fetchData() {
    event.preventDefault();

    const input = document.querySelector('.js-fetch-url');
    const url = input.value;
    
    fetch(url)
        .then(response => response.text())
        .then(data => {
            const resultContainer = document.querySelector('.js-fetch-result');
            resultContainer.textContent = data;
        })
        .catch(error => {
            alert('error')
    });
}
  
document.querySelector('.js-fetch-submit').addEventListener('click', fetchData);
  
// end test 3
  

// test 4
function sumEvenNumbers(numbers) {
    let sum = 0;
    for (let i = 0; i < numbers.length; i++) {
      if (numbers[i] % 2 === 0) {
        sum += numbers[i];
      }
    }
    return sum;
}
  
const resultBlock = document.querySelector('.page__test-sum');

const numbers = [1, 2, 3, 4, 5, 6];
const numbers2 = [1, 3, 5];
const numbers3 = [2, 4, 6];
const numbers4 = [2, 4, 6, 10, 11, 13];

let resultText = '';

resultText += `<span>В умові [1, 2, 3, 4, 5, 6], сумма чисел 2, 4, 6 = ${sumEvenNumbers(numbers)};</span>`;
resultText += `<span>В умові [1, 3, 5], парних чисел немає. = ${sumEvenNumbers(numbers2)};</span>`;
resultText += `<span>В умові [2, 4, 6], сумма чисел 2, 4, 6 = ${sumEvenNumbers(numbers3)};</span>`;
resultText += `<span>В умові [2, 4, 6, 10, 11, 13], сумма чисел 2, 4, 6, 10 = ${sumEvenNumbers(numbers4)};</span>`;

resultBlock.innerHTML = resultText;
// end test 4



// test 5
const users = [
    {id: 1, name: "John Doe", age: 25},
    {id: 2, name: "Jane Smith", age: 30},
    {id: 3, name: "Bob Johnson", age: 35},
    {id: 4, name: "Alice Brown", age: 20}
];

function sortUsersByAge(users) {
    const sortedUsers = users.sort((a, b) => a.age - b.age);
    const names = sortedUsers.map(user => user.name);
    return names;
}

function getUsersOverAge(users, age) {
    const filteredUsers = users.filter(user => user.age > age);
    const userObjects = filteredUsers.map(user => ({ name: user.name, age: user.age }));
    return userObjects;
}

function getUserAgeStats(users) {
    const statistics = {};
    users.forEach(user => {
        const age = user.age;
        if (statistics[age]) {
            statistics[age]++;
        } else {
            statistics[age] = 1;
        }
    });
    return statistics;
}

document.querySelector('.res1').textContent =  JSON.stringify(sortUsersByAge(users));
document.querySelector('.res2').textContent = JSON.stringify(getUsersOverAge(users, 25));
document.querySelector('.res3').innerHTML = JSON.stringify(getUserAgeStats(users));
// end test 5